import matplotlib.pyplot as plt
import numpy as np

T = [0.5, 0.7, 0.9, 1.1, 1.3, 1.5, 1.7, 1.9, 2.1, 2.3, 2.5]

### Correlation time ###

tau = [44, 76, 59, 25, 10, 14, 5, 6, 5, 2, 2]

### Energy and heat capacity ###

mean_energy = [-1.734111150167894, -1.6065632448320863, -1.4446997080361599, -1.1838693101713387, -0.9589189679253002, -0.7937623879423523,  -0.6858721524921304, -0.6031153290509046, -0.5353891063911227, -0.4763665460209869, -0.436199626829176]
error_energy = [0.006933190560640543, 0.01021151742084896, 0.0144772945740004, 0.021827861453915375, 0.02714859545475318, 0.030866527045599213, 0.03381579112985597, 0.03555621641282093, 0.03728377595946311, 0.0162941582847774, 0.01641288053809322]
mean_heat_capacity = [1.0199063247197866, 0.9671924977475892, 0.6246163251254538, 2.609696114487946, 4.761476113709891,  3.0828606899193836, 5.494424002441581, 3.9393267768798457, 3.614191811413221, 2.6729195767943326, 2.1867365296329853]
error_heat_capacity = [0.8476763744973733, 0.527663030231476, 0.8930842557974457, 2.7492916134304424, 7.808711522732819,  3.0828606899193836, 10.093797872764974, 7.169208869478258, 6.708371137855591, 4.9501813388718565, 4.040455785058087]

### Magnetization and magnetic susceptibility ###

mean_magnetization = [0.823300232678318, 0.7412760080665087, 0.6246163251254538, 0.22348679016429124, 0.11676365589553153, 0.0685941492848696, 0.06885295916605629, 0.05340232540156649, 0.049660899312977236, 0.04209770333716612, 0.04075889847626179]
error_magnetization = [0.005513441683262625, 0.00929727716151443, 0.013114493149372363, 0.031893975728442686, 0.028873953388273303, 0.024752754344719696, 0.0267230418821945, 0.0248764745581403, 0.025060243668171583, 0.011897520122643675, 0.011192433658223961]
mean_magnetic_susceptibility = [0.7962654259539024, 2.6705748675120993, 3.6062289735920516, 9.563152446133104, 9.131197989737203, 6.948277477574238, 9.113565782419252, 5.8637388712212815, 5.539687904126488, 3.45948082195556, 3.026084832398376]
error_magnetic_susceptibility = [0.41884409819926993, 1.1144686404733126, 2.298166753027829, 8.029767454192879,  12.85898501829984, 11.51372959193336, 17.048237458025277, 10.78386202424652, 10.253889177700689, 6.364682159422968, 5.584038444729105]

##### Adding an external magnetic field #####

### Correlation time ###

tau_ext = [10, 10, 10, 10, 9, 8, 12, 7, 5, 5, 10]

### Energy and heat capacity ###

mean_energy_ext = [-2.205388251929924, -2.0884299663877446, -1.9607096640255448, -1.8071877514675156, -1.6229347476876135, -1.420983670057281, -1.2081321570175036, -1.0095126431665444, -0.8455492162981213, -0.7245232464768034, -0.6380924322848613]
error_energy_ext = [0.05598091355721571, 0.05331038014840523, 0.049752161762449426, 0.04520550175368335, 0.041841641995489544, 0.036567912784018046, 0.03111909918834387, 0.027323574130058193, 0.022781339056661763, 0.01943430502951003, 0.017735364689409883]
mean_heat_capacity_ext = [94.46880030712664, 44.95566408328104, 26.14272809154071, 13.310841279983519, 9.793741867034084, 5.571676643121441, 2.6872762912377772, 2.5272627590586048, 1.5623425916598308, 0.9894821469795968, 0.5952821576740981]
error_heat_capacity_ext = [187.73236518554484, 88.89420073209736, 50.75279104700434, 25.14267678130349, 17.60444367684275, 9.067853013166536, 3.4898879476754208, 3.3361285498565416, 1.8964336320515318, 1.0227870970824784, 0.34582472447885076]

### Magnetization and magnetic susceptibility ###

mean_magnetization_ext = [0.9029105055707948, 0.8657949922303112, 0.8240101880766458, 0.7721736899125616, 0.7077900441647205, 0.6276713651741727, 0.5387389679530411, 0.44896570694436894, 0.36733773044516704, 0.3080252640488467, 0.2629160947389016]
error_magnetization_ext = [0.02253300979709154, 0.02104710542380842, 0.019879385055424866, 0.019389757899922307, 0.017539545893968056, 0.015551636503245687, 0.013562464051192671, 0.011857786538558816, 0.009931271824937837, 0.008695777837032839, 0.007741833169306357]
mean_magnetic_susceptibility_ext = [11.638563907079773, 8.178069990444342, 6.060125817670797, 3.5312602285497565, 3.2259222685513875, 2.158211662993158, 1.3352854177084532, 1.4748659948096807, 0.9137746986315187, 0.7819653733521822, 0.5512073314209422]
error_magnetic_susceptibility_ext = [23.181477524209537, 16.231678057591747, 11.872350990758077, 6.771506510074366, 5.9839183726352125, 3.585210917661913, 1.7366869166365035, 1.9857089777385144, 0.946592367822920, 0.6657226190451137, 0.22164765751417317]



error_heat_capacity_low = [min(error, mean_heat_capacity[i]) for i, error in enumerate(error_heat_capacity)]
error_magnetic_susceptibility_low = [min(error, mean_magnetic_susceptibility[i]) for i, error in enumerate(error_magnetic_susceptibility)]
error_heat_capacity_low_ext = [min(error, mean_heat_capacity_ext[i]) for i, error in enumerate(error_heat_capacity_ext)]
error_magnetic_susceptibility_low_ext = [min(error, mean_magnetic_susceptibility_ext[i]) for i, error in enumerate(error_magnetic_susceptibility_ext)]

plt.plot(T, tau, '+')
plt.xlabel('Temperature (J/k_b)')
plt.ylabel('correlation time (steps of update)')

fig2, ax2 = plt.subplots(2,2)
fig2.subplots_adjust(hspace=0.4)
fig2.subplots_adjust(wspace=0.6)
ax2[0][0].errorbar(T, mean_energy, error_energy, fmt='.')
ax2[0][0].set_title('a)')
ax2[0][0].set_xlabel('Temperature (J/k_b)')
ax2[0][0].set_ylabel('Energy per spin (J)')
ax2[1][0].errorbar(T, mean_heat_capacity, (error_heat_capacity_low, error_heat_capacity), fmt='.')
ax2[1][0].set_title('b)')
ax2[1][0].set_xlabel('Temperature (J/k_b)')
ax2[1][0].set_ylabel('Heat capacity per spin (k_b)')
ax2[0][1].errorbar(T, mean_magnetization, error_magnetization, fmt='.')
ax2[0][1].set_title('c)')
ax2[0][1].set_xlabel('Temperature (J/k_b)')
ax2[0][1].set_ylabel('Magnetization')
ax2[1][1].errorbar(T, mean_magnetic_susceptibility, (error_magnetic_susceptibility_low, error_magnetic_susceptibility), fmt='.')
ax2[1][1].set_title('d)')
ax2[1][1].set_xlabel('Temperature (J/k_b)')
ax2[1][1].set_ylabel('Magnetic susceptibility (1/J)')

fig3, ax3 = plt.subplots(2,2)
fig3.subplots_adjust(hspace=0.4)
fig3.subplots_adjust(wspace=0.6)
ax3[0][0].errorbar(T, mean_energy_ext, error_energy_ext, fmt='.')
ax3[0][0].set_title('a)')
ax3[0][0].set_xlabel('Temperature (J/k_b)')
ax3[0][0].set_ylabel('Energy per spin (J)')
ax3[1][0].errorbar(T, mean_heat_capacity_ext, (error_heat_capacity_low_ext, error_heat_capacity_ext), fmt='.')
ax3[1][0].set_title('b)')
ax3[1][0].set_xlabel('Temperature (J/k_b)')
ax3[1][0].set_ylabel('Heat capacity per spin (k_b)')
ax3[0][1].errorbar(T, mean_magnetization_ext, error_magnetization_ext, fmt='.')
ax3[0][1].set_title('c)')
ax3[0][1].set_xlabel('Temperature (J/k_b)')
ax3[0][1].set_ylabel('Magnetization')
ax3[1][1].errorbar(T, mean_magnetic_susceptibility_ext, (error_magnetic_susceptibility_low_ext, error_magnetic_susceptibility_ext), fmt='.')
ax3[1][1].set_title('d)')
ax3[1][1].set_xlabel('Temperature (J/k_b)')
ax3[1][1].set_ylabel('Magnetic susceptibility (1/J)')
plt.show()